<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <title>Logs</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #aaa;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #eee;
        }
#logsTable {
  width: 100%;
  border-collapse: collapse;
  font-family: Arial, sans-serif;
}

#logsTable th, #logsTable td {
  border: 1px solid #ddd;
  padding: 8px;
}

#logsTable th {
  background-color: #4CAF50;
  color: white;
  text-align: left;
}

#logsTable tr:nth-child(even) {
  background-color: #f2f2f2;
}

#logsTable tr:hover {
  background-color: #ddd;
}
    </style>
</head>
<body>
    <h1>Logs do Sistema</h1>
    <table id="logsTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Usuário</th>
                <th>Ação</th>
                <th>Timestamp</th>
            </tr>
        </thead>
        <tbody>
            <!-- Linhas serão inseridas aqui pelo JS -->
        </tbody>
    </table>

    <script>
        async function carregarLogs() {
            try {
                const response = await fetch('/logs/api');
                if (!response.ok) {
                    throw new Error('Erro ao carregar logs');
                }
                const logs = await response.json();
                const tbody = document.querySelector('#logsTable tbody');
                tbody.innerHTML = '';

                logs.forEach(log => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${log.id}</td>
                        <td>${log.username || 'Anônimo'}</td>
                        <td>${log.action}</td>
                        <td>${new Date(log.timestamp).toLocaleString('pt-BR')}</td>
                    `;
                    tbody.appendChild(tr);
                });
            } catch (error) {
                alert('Falha ao carregar logs: ' + error.message);
            }
        }

        // Carrega os logs assim que a página termina de carregar
        window.addEventListener('DOMContentLoaded', carregarLogs);

    function filtrarLogs() {
  const input = document.getElementById('searchInput').value.toLowerCase();
  const rows = document.querySelectorAll('#logsTable tbody tr');
  
  rows.forEach(row => {
    const username = row.cells[1].textContent.toLowerCase();
    const action = row.cells[2].textContent.toLowerCase();
    if (username.includes(input) || action.includes(input)) {
      row.style.display = '';
    } else {
      row.style.display = 'none';
    }
  });
}
    </script>
</body>
</html>
